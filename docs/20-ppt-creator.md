# PPT Creator - PPT创建器

## 简介

PPT Creator skill用于从主题或文档创建专业的幻灯片。生成结构化内容，带有数据驱动的图表、演讲者笔记和完整的PPTX文件。应用说服性讲故事原则（金字塔原则、断言-证据）。支持多种格式（Marp、PowerPoint）。

## 使用场景

- "制作演示文稿/deck/PPT/幻灯片"关于任何主题
- "改进/优化演示文稿/推介/演示"
- 将分散的材料转化为结构化、有说服力的幻灯片deck
- 创建带有数据可视化和演讲者笔记的演示文稿
- 为业务评审、产品推介、教育内容或报告构建decks

## 快速开始

### 1. 收集意图

如果缺少关键信息，使用**10个最小问题**（references/INTAKE.md）来收集上下文或应用安全默认值。然后遵循工作流（references/WORKFLOW.md）来生成大纲、幻灯片草稿、图表和演讲者笔记。生成后，使用rubric（references/RUBRIC.md）自我评估；如果分数< 75，自动优化最多2次迭代直到≥ 75再交付。见**可交付成果**部分以获取最终输出结构。

### 2. 构建故事结构

应用**金字塔原则**来建立"一个结论 → 3-5个顶级原因 → 支持证据"。每张幻灯片使用**断言式标题**（完整句子），正文内容提供证据（图表/表格/图/数据点）。模板在references/TEMPLATES.md中。

### 3. 选择图表

使用**图表选择字典**（references/VIS-GUIDE.md）来为每个点选择最合适的可视化。如果用户提供数据（表格/CSV），**可选地**调用`scripts/chartkit.py`来生成PNG图表；否则，创建带有必需数据字段列表的占位符图。

### 4. 布局和样式

遵循references/STYLE-GUIDE.md以获取字体大小、行间距、空白、对比率、调色板和可访问性（WCAG AA合规）。

### 5. 演讲者笔记

为每张幻灯片生成45-60秒的演讲者笔记，结构化为：开场 → 核心断言 → 证据解释 → 过渡。

### 6. 自我检查和评分

使用references/CHECKLIST.md进行飞行前检查，然后用references/RUBRIC.md评分。如果总分< 75，识别最弱的3个项目并优化；重复评分（最多2次迭代）。

### 7. 可交付成果（所有保存到`/output/`）
- `/output/slides.md`：Markdown幻灯片（Marp/Reveal.js兼容），带有断言式标题 + 要点/图表占位符 + 笔记
- `/output/assets/*.png`：生成的图表（如适用）
- `/output/notes.md`：完整演讲者笔记和交付大纲
- `/output/refs.md`：引用和数据源
- `/output/presentation.pptx`：如果`python-pptx`可用，导出到PPTX；否则，保留Markdown并在第一屏中包含"一键转换为PPTX"的说明（不阻塞交付）

## 编排模式（端到端自动化）

当用户请求"完整"或"演示文稿就绪"的可交付成果时，ppt-creator自动编排完整管道：内容创建 → 数据合成 → 图表生成 → 双路径PPTX创建（Marp + document-skills:pptx）→ 图表插入。这通常交付**两个完整的PPTX文件**，具有不同的样式以供用户比较。

**激活：** 像"完整PPTX"、"最终可交付成果"、"准备好演示"这样的短语
**持续时间：** 4-6分钟（并行执行）
**输出：** presentation_marp_with_charts.pptx + presentation_pptx_with_charts.pptx

有关编排详情，请参阅`references/ORCHESTRATION_OVERVIEW.md`（从这里开始），然后根据需要导航到专门指南。

## 核心原则（必须遵循）

- **信息组织**：结论优先，然后证据（金字塔原则）。每张幻灯片仅传达**一个核心思想**。标题必须是**可测试的断言语句**，而不是主题标签。
- **证据优先**：使用图表/表格/证据块而不是长段落；每张幻灯片限制为3-5个要点。
- **数据可视化**：图表选择和标签（轴/单位/来源）必须符合references/VIS-GUIDE.md。如果数据不足，提供"占位符图表 + 缺失字段列表"。
- **可访问性**：颜色和文本对比必须满足AA标准（见STYLE-GUIDE）。为图表和图像提供alt/可读描述。
- **可重用性**：使用一致的命名、稳定的路径、可重现的输出。不要在代码中硬编码随机数字。
- **安全和依赖项**：未经许可不要抓取网络。仅在用户提供数据时运行脚本。如果`matplotlib/pandas`不可用，回退到文本 + 占位符图说明。

## 工作流概述

**阶段0 - 归档输入**：记录用户的原始请求、使用的默认值和做出的假设。

**阶段1 - 构建目标**：将目标重写为"谁在何时采取什么行动"（清晰的CTA）。

**阶段2 - 故事线**：使用金字塔原则来定义"一个句子结论 → 3-5个第一级原因 → 证据"。

**阶段3 - 大纲和幻灯片标题**：创建12-15张幻灯片的章节骨架。每张幻灯片有一个断言式标题。

**阶段4 - 证据和图表**：使用VIS-GUIDE中的图表选择字典。如果提供数据，调用chartkit.py生成PNG；否则，创建占位符 + 必需字段列表。

**阶段5 - 布局和可访问性**：应用STYLE-GUIDE以获取字体大小、间距、对比率、调色板；统一单位和十进制位。

**阶段6 - 演讲者笔记**：每张幻灯片生成45-60秒的笔记：开场 → 断言 → 证据解释 → 过渡。

**阶段7 - 自我检查和评分**：运行CHECKLIST；用RUBRIC评分。如果分数< 75，专注于最弱的3个项目，优化，重新评分（最多2次迭代）。

**阶段8 - 打包可交付成果**：生成`/output/`目录，包含slides.md / notes.md / refs.md / assets/*.png。如果`python-pptx`可用，导出PPTX。

**阶段9 - 重用说明**：在notes.md末尾附加"用你自己的数据/颜色替换的5步指南"。

## 资源

### references/INTAKE.md
**最小10项问卷**（如缺失则使用默认值）：
1. 受众是谁？（默认：一般公众）
2. 核心目标？（默认："理解并接受"一个命题）
3. 期望的行动/决策？（默认：同意在会议后进行到下一步）
4. 持续时间和幻灯片数量限制？（默认：15-20分钟，12-15张幻灯片）
5. 语气和风格？（默认：专业、清晰、友好）
6. 主题范围和边界？（默认：给定主题 + 1层相关）
7. 必须包含的点/禁忌？（默认：无）
8. 可用的数据/表格？（默认：无；可以生成结构占位符 + 必需字段列表）
9. 品牌和视觉约束？（默认：内置中性主题）
10. 可交付成果格式偏好？（默认：slides.md + 可选PNG图表；如可用则导出PPTX）

### references/WORKFLOW.md
从"主题"到"演示文稿就绪输出"的详细分步过程。

### references/TEMPLATES.md
**幻灯片模板库**（断言-证据风格）：
- 封面、目录、问题陈述、机会/目标、解决方案概述、证据1-3、风险和缓解、案例研究/比较、路线图/时间表、结论和行动、备份幻灯片
- 微模板：比较（A vs B）、金字塔摘要、过程4步、KPI仪表板、地理分布、漏斗、帕累托、敏感性、成本结构（瀑布）、贡献（堆叠）

### references/VIS-GUIDE.md
**数据可视化和标签标准**：
- 图表选择字典（常见问题 → 图表类型）
- 标签和单位（轴、单位、数据范围、时间范围；页脚中的来源）
- 可访问性和对比（WCAG 2.1 AA：文本 vs 背景 ≥ 4.5:1；UI元素 ≥ 3:1）
- 断言-证据写作提示

### references/STYLE-GUIDE.md
**布局和样式**（中性主题，支持品牌替换）：
- 画布：16:9；安全边距 ≥ 48px；网格列间距24px
- 字体：中文（Source Han Sans/苹方/Hiragino Sans），英文（Inter/Calibri）
- 字体大小：标题34-40，副标题24-28，正文18-22，页脚14-16
- 行间距：标题1.1，正文1.3；要点间距 ≥ 8px
- 调色板（AA合规）：深墨 #1F2937 / 背景 #FFFFFF / 强调 #2563EB / 强调 #DC2626
- 组件：统一的6-8px边框半径；图表和图像带有8px内边距
- 图像：为屏幕阅读器添加简要alt描述
- 页面密度：每张幻灯片≤ 70个词（不包括说明文字）

### references/RUBRIC.md
**PPT质量评分rubric**（100分；≥ 75以交付）：
每项评分0-10：
1. **目标清晰度**：受众、目标、CTA定义良好
2. **故事结构**：金字塔结构完整，层次清晰
3. **幻灯片断言**：标题是"断言语句"并由证据支持
4. **证据质量**：数据/案例/引用充分、可信、一致校准
5. **图表适配**：选择正确、标签完整、可读
6. **视觉和可访问性**：对比、字体大小、空白、颜色合规
7. **连贯性和过渡**：自然的章节和页面过渡
8. **可演讲性**：每张幻灯片45-60秒，自然语言
9. **可交付成果完整**：slides.md / notes.md / refs.md /（可选）assets/*.png
10. **健壮性**：缺口明确标记，回退计划和下一步提供

自我评估过程：先运行CHECKLIST，然后评分每项并写出得分最低的3项 + 改进行动。如果总分< 75，应用行动并重新评分（最多2次迭代）。

### references/CHECKLIST.md
交付前最终质量保证的飞行前检查表。

### references/EXAMPLES.md
**两个使用示例**：
- **示例A**：超简单主题（"咖啡"）→ 触发最小问卷，生成带有占位符图表的12页框架
- **示例B**：带有附加CSV的小型业务月度审查 → 解析数据，按VIS-GUIDE选择图表，调用chartkit.py，如果分数< 75则优化1-2次迭代

### scripts/chartkit.py
**ppt-creator的最小图表渲染器**

**用法：**
```bash
python scripts/chartkit.py \
  --data path/to/data.csv \
  --type line \
  --x date \
  --y sales profit \
  --out output/assets \
  --filename kpi_trend.png \
  --title "Monthly KPIs"
```

**注意：**
- 需要：`pandas`、`matplotlib`
- 回退：如果包不可用，打印指令消息并退出(0)
- 使用matplotlib默认值以实现可读性（没有硬编码的品牌颜色）

## 高级提示

- 此skill**补充**（不冲突）Anthropic的内置PowerPoint生成功能。使用此skill来生成"高质量结构和内容"，然后可选地调用系统能力来导出最终PPTX文件。
- 对于复杂的数据分析需求，在调用ppt-creator之前结合其他skills（例如，数据分析、图表）。
- 该skill设计为宽容的：缺失信息触发安全默认值而不是阻塞进度。
