# Writing Plans - 编写计划

## 简介

Writing Plans skill用于在开始实现之前，将spec或需求转化为详细的、可执行的实施计划。

## 使用场景

- 有spec或需求需要实现
- 需要将模糊的想法转化为具体步骤
- 准备开始功能开发
- 需要创建详细的实施路线图

## 核心流程

### 1. 理解需求

- 阅读spec/需求文档
- 识别所有要求
- 理解约束和限制
- 识别依赖关系

### 2. 分解任务

- 将需求分解为小的、可管理的任务
- 每个任务应该：
  - 独立可测试
  - 有明确的成功标准
  - 可以在1-2小时内完成
  - 有清晰的验收标准

### 3. 组织任务

- 按逻辑顺序组织任务
- 识别依赖关系
- 创建任务分组
- 估算每个任务的时间

### 4. 编写计划

创建包含以下内容的计划文档：
- 概述和目标
- 前提条件
- 任务列表（按优先级排序）
- 验证步骤
- 回退计划

## 计划格式

### 计划结构

```markdown
# [功能名称] 实施计划

## 概述
[1-2段描述要实现什么以及为什么]

## 目标
- [目标1]
- [目标2]
- [目标3]

## 前提条件
- [条件1]
- [条件2]

## 任务

### Task 1: [任务名称]
**优先级：** 高/中/低
**估算：** X小时

**步骤：**
1. [步骤1]
2. [步骤2]
3. [步骤3]

**验收标准：**
- [标准1]
- [标准2]

**依赖：** 无 / Task X

### Task 2: [任务名称]
[相同格式...]

## 验证
- [验证步骤1]
- [验证步骤2]

## 回退计划
如果遇到问题：
1. [回退步骤1]
2. [回退步骤2]
```

## 使用方法

### 1. 创建计划

当有spec或需求时：
1. 阅读并理解需求
2. 分解为任务
3. 编写计划文档
4. 保存到 `docs/plans/YYYY-MM-DD-<feature>-plan.md`

### 2. 审查计划

- 与团队/伙伴审阅计划
- 确认所有任务必要
- 确认顺序合理
- 确认估算现实

### 3. 执行计划

使用 `executing-plans` 或 `subagent-driven-development` skill来执行计划。

## 关键原则

- **小任务** - 每个任务应该在1-2小时内完成
- **清晰验收** - 每个任务必须有明确的成功标准
- **依赖清晰** - 识别并文档化所有依赖关系
- **可测试** - 每个任务应该独立可测试
- **现实估算** - 基于复杂性而不是乐观主义

## 示例

```markdown
# 用户认证功能实施计划

## 概述
实现用户认证功能，支持邮箱密码和Google OAuth登录。此功能允许用户创建账户、登录和管理会话。

## 目标
- 用户可以用邮箱和密码创建账户
- 用户可以用Google OAuth登录
- 用户可以安全地登出
- 会话在24小时后过期

## 前提条件
- 数据库已设置
- Google OAuth客户端ID已配置
- JWT密钥已生成

## 任务

### Task 1: 设置数据库schema
**优先级：** 高
**估算：** 1小时

**步骤：**
1. 创建users表
2. 添加索引到email字段
3. 创建sessions表
4. 运行迁移

**验收标准：**
- users表存在并包含所有必需字段
- email字段有唯一索引
- sessions表存在
- 迁移成功运行

**依赖：** 无

### Task 2: 实现邮箱密码注册
**优先级：** 高
**估算：** 2小时

**步骤：**
1. 创建注册API端点
2. 实现密码哈希
3. 验证邮箱格式
4. 保存用户到数据库

**验收标准：**
- POST /api/register存在
- 密码使用bcrypt哈希
- 无效邮箱返回400错误
- 有效邮箱创建用户记录

**依赖：** Task 1

### Task 3: 实现Google OAuth
**优先级：** 中
**估算：** 3小时

**步骤：**
1. 设置OAuth流程
2. 实现回调端点
3. 创建/更新用户记录
4. 生成JWT token

**验收标准：**
- 用户可以重定向到Google OAuth
- 回调成功处理
- JWT token返回给客户端
- 用户记录创建或更新

**依赖：** Task 1

## 验证
- 运行所有注册测试
- 运行所有登录测试
- 手动测试OAuth流程
- 验证会话过期

## 回退计划
如果OAuth集成太复杂：
1. 先实现邮箱密码登录
2. OAuth作为后续任务
```

## 输出

计划文档保存到：`docs/plans/YYYY-MM-DD-<feature>-plan.md`
